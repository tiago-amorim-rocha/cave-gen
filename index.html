<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cave Field Lab</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='14' fill='%234f46e5'/%3E%3Ccircle cx='16' cy='16' r='7' fill='%23e7e9ec'/%3E%3C/svg%3E" />
  </head>
  <body>
  <!-- Header removed for a cleaner layout -->

    <div class="workspace">
      <section class="controls">
        <div class="row">
          <label>
          Algorithm
          <select id="algo">
            <option value="fbm">FBM Perlin</option>
            <option value="fbmWarp">FBM (domain-warped)</option>
            <option value="fbmBillow">FBM Billow</option>
            <option value="worleyF1">Worley F1</option>
            <option value="worleyF2F1">Worley F2-F1 (ridges)</option>
            <option value="metaballs">Metaballs</option>
            <option value="metaballsWarp">Metaballs (domain-warped)</option>
            <option value="perlinCells">Perlin + Cells</option>
            <option value="perlinMetaballs">Perlin + Metaballs</option>
            <option value="singleCave">Single Cave</option>
            <option value="caveLayout">Cave Layout</option>
            <option value="randomWalk">Random Walk</option>
          </select>
          </label>

          <label>
            Width
            <input id="width" type="number" min="64" max="4096" value="512" />
          </label>
          <label>
            Height
            <input id="height" type="number" min="64" max="4096" value="512" />
          </label>
          
        <label>
          Seed
          <input id="seed" type="number" value="1" />
        </label>
        <button id="randomize">Randomize</button>
        <button id="render">Render</button>
        <button id="download">Download PNG</button>
      </div>

        <div class="row threshold-row">
          <label class="checkbox">
            <input id="thresholdEnabled" type="checkbox" />
            Apply Threshold
          </label>
          <label class="slider">
            Cutoff
            <div class="slider-wrap">
              <input id="threshold" type="range" min="0" max="1" step="0.01" value="0.5" />
              <output id="thresholdValue">0.50</output>
            </div>
          </label>
          <label class="slider">
            Soft Width
            <div class="slider-wrap">
              <input id="thresholdWidth" type="range" min="0" max="1" step="0.01" value="0.05" />
              <output id="thresholdWidthValue">0.05</output>
            </div>
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="fbmBillow perlinCells perlinMetaballs">
            Billow Power
            <input id="billowPower" type="number" min="0.2" max="2" step="0.05" value="0.85" />
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="singleCave">
            Cave Radius (px)
            <input id="caveRadius" type="number" min="16" max="2048" step="4" value="180" />
          </label>
          <label data-scope="singleCave caveLayout">
            Irregularity
            <input id="caveIrregularity" type="number" min="0" max="1.5" step="0.05" value="0.35" />
          </label>
          <label data-scope="singleCave caveLayout">
            Detail Scale
            <input id="caveDetailScale" type="number" min="0.2" max="10" step="0.1" value="2.0" />
          </label>
          <label data-scope="singleCave caveLayout">
            Angular Samples
            <input id="caveSamples" type="number" min="32" max="2048" step="16" value="256" />
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="singleCave caveLayout">
            Edge Feather (px)
            <input id="edgeFeather" type="number" min="0.5" max="100" step="0.5" value="8" />
          </label>
          <label data-scope="singleCave caveLayout">
            Smooth Iterations
            <input id="caveSmooth" type="number" min="0" max="5" step="1" value="2" />
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="fbm fbmWarp fbmBillow perlinCells perlinMetaballs metaballsWarp">
            Scale
            <input id="scale" type="number" min="1" max="4096" step="1" value="256" />
          </label>
          <label data-scope="fbm fbmWarp fbmBillow perlinCells perlinMetaballs">
            Octaves
            <input id="octaves" type="number" min="1" max="8" value="5" />
          </label>
          <label data-scope="fbm fbmWarp fbmBillow perlinCells perlinMetaballs">
            Lacunarity
            <input id="lacunarity" type="number" min="1" max="4" step="0.1" value="2.0" />
          </label>
          <label data-scope="fbm fbmWarp fbmBillow perlinCells perlinMetaballs">
            Gain
            <input id="gain" type="number" min="0" max="1" step="0.05" value="0.5" />
          </label>
          <label data-scope="fbmWarp metaballsWarp">
            Warp Strength
            <input id="warp" type="number" min="0" max="1024" step="1" value="80" />
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="worleyF1 worleyF2F1 perlinCells">
            Worley Cell Size
            <input id="cellSize" type="number" min="8" max="1024" step="1" value="64" />
          </label>
          <label data-scope="metaballs metaballsWarp perlinMetaballs">
            Metaball Count
            <input id="ballCount" type="number" min="1" max="2000" value="120" />
          </label>
          <label data-scope="metaballs metaballsWarp perlinMetaballs">
            Metaball Radius
            <input id="ballRadius" type="number" min="2" max="512" value="24" />
          </label>
          <label data-scope="caveLayout">
            Cave Count
            <input id="layoutCount" type="number" min="1" max="200" value="12" />
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="caveLayout">
            Min Radius (px)
            <input id="layoutMinRadius" type="number" min="12" max="1024" step="1" value="90" />
          </label>
          <label data-scope="caveLayout">
            Max Radius (px)
            <input id="layoutMaxRadius" type="number" min="12" max="2048" step="1" value="180" />
          </label>
          <label data-scope="caveLayout">
            Padding (px)
            <input id="layoutPadding" type="number" min="0" max="200" step="1" value="12" />
          </label>
        </div>

        <div class="row algo-row">
          <label data-scope="randomWalk">
            Walkers
            <input id="walkCount" type="number" min="1" max="500" value="20" />
          </label>
          <label data-scope="randomWalk">
            Max Steps
            <input id="walkSteps" type="number" min="10" max="10000" step="10" value="800" />
          </label>
          <label data-scope="randomWalk">
            Carve Radius (px)
            <input id="walkRadius" type="number" min="1" max="32" step="1" value="2" />
          </label>
          <label data-scope="randomWalk">
            Branch Chance
            <input id="walkBranch" type="number" min="0" max="1" step="0.01" value="0.05" />
          </label>
          <label data-scope="randomWalk">
            Vertical Bias
            <input id="walkBias" type="number" min="0" max="1" step="0.05" value="0.5" />
          </label>
          <label data-scope="randomWalk">
            Walker Cohesion
            <input id="walkCohesion" type="number" min="0" max="1" step="0.05" value="0" />
          </label>
          <label data-scope="randomWalk">
            Edge Force Start (px)
            <input id="walkEdgeSoft" type="number" min="0" max="512" step="1" value="48" />
          </label>
          <label data-scope="randomWalk">
            Edge Force Max (px)
            <input id="walkEdgeHard" type="number" min="0" max="512" step="1" value="24" />
          </label>
          <label data-scope="randomWalk">
            Edge Strength
            <input id="walkEdgeStrength" type="number" min="0" max="1" step="0.05" value="0.25" />
          </label>
          <label data-scope="randomWalk">
            Edge Power
            <input id="walkEdgePower" type="number" min="0.5" max="8" step="0.5" value="4" />
          </label>
          <label data-scope="randomWalk">
            Drift Angle (deg)
            <input id="walkDriftAngle" type="number" min="0" max="360" step="1" value="0" />
          </label>
          <label data-scope="randomWalk">
            Drift Strength
            <input id="walkDriftStrength" type="number" min="0" max="1" step="0.05" value="0" />
          </label>
          <label data-scope="randomWalk">
            Walk Speed (steps/sec)
            <input id="walkSpeed" type="number" min="1" max="60" step="1" value="60" />
          </label>
          <button id="walkReset" data-scope="randomWalk" class="secondary">Reset Walk</button>
        </div>

        <div class="row post-row">
          <label class="slider">
            Blur Radius (px)
            <div class="slider-wrap">
              <input id="blurRadius" type="range" min="0" max="30" step="1" value="0" />
              <output id="blurRadiusValue">0</output>
            </div>
          </label>
        </div>
      </section>

      <main>
        <canvas id="canvas" width="512" height="512"></canvas>
      </main>
    </div>

    <!-- Footer tip removed to simplify UI -->

    <script type="module" src="src/main.js"></script>
  </body>
  </html>
